--// Nervox Stand Bot
--// Made by kryvendev
--// Script Version: v1.1.0
--// NOTES: 
--   - Version number increases +0.0.1 with every update
--   - Status panel = left side
--   - Info panel = right side

--// ========= SERVICES ========= \\--
local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local TeleportService = game:GetService("TeleportService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LP = Players.LocalPlayer

--// ========= SETTINGS ========= \\--
local OwnerId = getgenv().OwnerId or 0
local BotSettings = getgenv().BotSettings or {}
local ScriptVersion = "v1.1.0"

-- FPS Limiter (based on MaxFps setting)
local MaxFps = BotSettings.MaxFps or 45
RunService.Heartbeat:Connect(function()
    if MaxFps > 0 then
        task.wait(1 / MaxFps)
    end
end)

--// ========= VARIABLES ========= \\--
local Whitelist = { [OwnerId] = true }
local HideConnection, DropConnection, AutoConnection
local CurrentAction = "Idle"
local FPS = 0

--// ========= FPS COUNTER ========= \\--
task.spawn(function()
    local lastTime = tick()
    local frames = 0
    while true do
        frames += 1
        if tick() - lastTime >= 1 then
            FPS = frames
            frames = 0
            lastTime = tick()
        end
        task.wait()
    end
end)

--// ========= GUI CREATION ========= \\--

-- Status Panel (Left)
local StatusGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
StatusGui.Name = "NervoxStatus"
local StatusFrame = Instance.new("Frame", StatusGui)
StatusFrame.Size = UDim2.new(0, 200, 0, 50)
StatusFrame.Position = UDim2.new(0, 10, 0.5, -25)
StatusFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
StatusFrame.BorderSizePixel = 0
Instance.new("UICorner", StatusFrame).CornerRadius = UDim.new(0, 8)
local StatusLabel = Instance.new("TextLabel", StatusFrame)
StatusLabel.Size = UDim2.new(1, 0, 1, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.TextColor3 = Color3.fromRGB(0,255,0)
StatusLabel.Font = Enum.Font.SourceSansBold
StatusLabel.TextSize = 20
StatusLabel.Text = "Status: Idle"

-- Info Panel (Right)
local InfoGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
InfoGui.Name = "NervoxInfo"
local InfoFrame = Instance.new("Frame", InfoGui)
InfoFrame.Size = UDim2.new(0, 200, 0, 100)
InfoFrame.Position = UDim2.new(1, -210, 0.5, -50)
InfoFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
InfoFrame.BorderSizePixel = 0
Instance.new("UICorner", InfoFrame).CornerRadius = UDim.new(0, 8)

local OwnerLabel = Instance.new("TextLabel", InfoFrame)
OwnerLabel.Size = UDim2.new(1, 0, 0, 30)
OwnerLabel.Position = UDim2.new(0, 0, 0, 0)
OwnerLabel.BackgroundTransparency = 1
OwnerLabel.TextColor3 = Color3.new(1,1,1)
OwnerLabel.Font = Enum.Font.SourceSansBold
OwnerLabel.TextSize = 18
OwnerLabel.Text = "Owner: " .. (Players:GetPlayerByUserId(OwnerId) and Players:GetPlayerByUserId(OwnerId).DisplayName or "Unknown")

local VersionLabel = Instance.new("TextLabel", InfoFrame)
VersionLabel.Size = UDim2.new(1, 0, 0, 30)
VersionLabel.Position = UDim2.new(0, 0, 0, 30)
VersionLabel.BackgroundTransparency = 1
VersionLabel.TextColor3 = Color3.new(1,1,0)
VersionLabel.Font = Enum.Font.SourceSansBold
VersionLabel.TextSize = 18
VersionLabel.Text = "Version: " .. ScriptVersion

local FpsLabel = Instance.new("TextLabel", InfoFrame)
FpsLabel.Size = UDim2.new(1, 0, 0, 30)
FpsLabel.Position = UDim2.new(0, 0, 0, 60)
FpsLabel.BackgroundTransparency = 1
FpsLabel.TextColor3 = Color3.new(0,1,0)
FpsLabel.Font = Enum.Font.SourceSansBold
FpsLabel.TextSize = 18
FpsLabel.Text = "FPS: 0"

-- Update GUI constantly
task.spawn(function()
    while true do
        StatusLabel.Text = "Status: " .. CurrentAction
        FpsLabel.Text = "FPS: " .. tostring(FPS)
        task.wait(0.2)
    end
end)

--// ========= UTILITIES ========= \\--
local function sendChat(msg)
    local ch = TextChatService.TextChannels:FindFirstChild("RBXGeneral")
    if ch then ch:SendAsync(msg) end
end

local function stopAll()
    if HideConnection then HideConnection:Disconnect() HideConnection = nil end
    if DropConnection then DropConnection:Disconnect() DropConnection = nil end
    if AutoConnection then AutoConnection:Disconnect() AutoConnection = nil end
    CurrentAction = "Idle"
end

local function summonTo(player)
    if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        (LP.Character or LP.CharacterAdded:Wait()):MoveTo(player.Character.HumanoidRootPart.Position)
    end
    CurrentAction = "Summoning"
end

local function hideBot()
    stopAll()
    CurrentAction = "Hiding"
    local char = LP.Character or LP.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    HideConnection = RunService.Heartbeat:Connect(function()
        hrp.CFrame = CFrame.new(
            math.random(-50, 50),
            30 + math.random(0, 10),
            math.random(-50, 50)
        )
        task.wait(0.1)
    end)
end

local function dropCash(amount)
    stopAll()
    CurrentAction = "Dropping Cash"
    local amt = math.clamp(tonumber(amount) or 0, 1, 15000)
    local args = { "DropMoney", tostring(amt) }
    ReplicatedStorage:WaitForChild("MainEvent"):FireServer(unpack(args))
    CurrentAction = "Idle"
end

local function autoDrop(amount)
    stopAll()
    CurrentAction = "Auto Dropping"
    local amt = math.clamp(tonumber(amount) or 0, 1, 15000)
    local args = { "DropMoney", tostring(amt) }
    sendChat("Autodropping " .. amt .. " | say stop! to stop")
    DropConnection = RunService.Heartbeat:Connect(function()
        ReplicatedStorage:WaitForChild("MainEvent"):FireServer(unpack(args))
        task.wait(0.5)
    end)
end

-- Auto strafe
local function autoStrafe(target)
    stopAll()
    CurrentAction = "Strafing"
    local char = LP.Character or LP.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    local hum = char:FindFirstChildOfClass("Humanoid")
    local startTime = tick()

    AutoConnection = RunService.Heartbeat:Connect(function()
        if not target or not target.Parent then stopAll() return end
        local targetChar = target.Character
        local targetHum = targetChar and targetChar:FindFirstChildOfClass("Humanoid")
        local targetHRP = targetChar and targetChar:FindFirstChild("HumanoidRootPart")
        if not targetChar or not targetHRP or not targetHum then return end
        if targetHum.Health <= 0 then stopAll() return end
        if tick() - startTime >= BotSettings.StrafeDuration then stopAll() return end

        local angle = tick() * BotSettings.StrafeSpeed
        local offset = Vector3.new(math.cos(angle), 0, math.sin(angle)) * BotSettings.StrafeDistance
        local targetCFrame = CFrame.new(targetHRP.Position + offset, targetHRP.Position)
        hrp.CFrame = hrp.CFrame:Lerp(targetCFrame, 0.25)
        hum.Jump = true
    end)
end

local function findPlayerByName(query)
    query = query:lower():gsub("^%s+", ""):gsub("%s+$", "")
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr.Name:lower():find(query, 1, true) or (plr.DisplayName and plr.DisplayName:lower():find(query, 1, true)) then
            return plr
        end
    end
end

--// ========= CHAT LISTENER ========= \\--
TextChatService.OnIncomingMessage = function(message)
    local src = message.TextSource
    local sender = src and Players:GetPlayerByUserId(src.UserId)
    local msgText = message.Text or ""
    local txt = msgText:lower()

    local allowed = src and (src.UserId == OwnerId or Whitelist[src.UserId])
    if not allowed then return end

    if txt == "summon!" or txt == "s" then
        summonTo(sender)
    elseif txt:sub(1,9) == "dropcash!" then
        dropCash(msgText:sub(10))
    elseif txt:sub(1,9) == "autodrop!" then
        autoDrop(msgText:sub(10))
    elseif txt:sub(1,5) == "auto!" then
        local query = msgText:sub(7)
        local target = findPlayerByName(query)
        if target then autoStrafe(target) end
    elseif txt == "hide!" then
        hideBot()
    elseif txt == "stop!" then
        stopAll()
        sendChat("Stopped all commands.")
    elseif txt == "creds!" then
        sendChat("Script made by KryvenDev")
    elseif txt == "version!" then
        sendChat("Current Script Version: " .. ScriptVersion)
    elseif txt == "cmds!" then
        sendChat("[1/3] summon!/s, auto! <user>, dropcash! <amt>, autodrop! <amt>")
        sendChat("[2/3] hide!, stop!, creds!, version!, chatlogs!")
        sendChat("[3/3] whitelist!, unwhitelist!, checkwl!, rj! (owner only)")
    end
end
